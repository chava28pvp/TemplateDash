/* ======= Base tabla (modo oscuro) ======= */
.kpi-table {
  border-collapse: separate;
  border-spacing: 0;
  table-layout: auto;
  width: 100%;
  background: #1e1e1e;

  --hdr-h1: 28px;   /* fila 1: Networks */
  --hdr-h2: 28px;   /* fila 2: Grupos */
  --hdr-h3: 28px;   /* fila 3: Sub-headers */

  color: #f1f1f1;
}

/* Rejilla completa */
.kpi-table th,
.kpi-table td {
  border: 1px solid #2d2d2d;
}

/* Compacto */
.kpi-table.compact {
  font-size: 0.85rem;
}
.kpi-table.compact td,
.kpi-table.compact th {
  padding: 0.25rem 0.5rem;
}

/* ======= Encabezados ======= */
.kpi-table thead th {
  text-align: center;
  vertical-align: middle;
  background: #2a2a2a;
  color: #f1f1f1;
  font-weight: 600;
  position: sticky;
  z-index: 2;

  /* evita “saltos” */
  min-height: 32px;
  line-height: 1.2;
  white-space: nowrap;
}
.kpi-table thead tr:nth-child(1) th { top: 0; }
.kpi-table thead tr:nth-child(2) th { top: var(--hdr-h1); }
.kpi-table thead tr:nth-child(3) th { top: calc(var(--hdr-h1) + var(--hdr-h2)); }

/* Nivel 1 (Networks) */
.kpi-table .th-network {
  background: #333;
  font-weight: 700;
  border-bottom: 2px solid #444;
}

/* Nivel 2 (Grupos) */
.kpi-table .th-group {
  background: #2f2f2f;
  font-weight: 700;
  border-top: 1px solid #444;
  border-bottom: 2px solid #444;
  border-right: 2px solid #444;
}

/* Nivel 3 (Sub-headers) */
.kpi-table .th-sub {
  background: #2a2a2a;
  font-weight: 600;
  border-bottom: 1px solid #444;
  border-right: 1px solid #444;
}
.kpi-table .th-end-of-group {
  border-right: 2px solid #555 !important;
}

/* ======= Cuerpo ======= */
.kpi-table tbody td {
  border-right: 1px solid #333;
  border-bottom: 1px solid #333;
}
.kpi-table tbody td.td-end-of-group {
  border-right: 2px solid #555 !important;
}
.kpi-table tbody tr:last-child td {
  border-bottom: 1px solid #444;
}

/* Rayado suave + hover */
.kpi-table tbody tr:nth-child(odd) td {
  background: #1b1b1b;
}
.kpi-table tbody tr:hover td {
  background: #2b2b2b;
}

/* ======= Columnas fijas (ajustadas + hover + fuente más pequeña) ======= */
.kpi-table .th-left,
.kpi-table .td-key {
  position: sticky;
  left: 0;
  z-index: 3;
  background: #222 !important;
  box-shadow: 2px 0 0 rgba(0,0,0,0.6);
  min-width: 96px;          /* ↓ antes 140px */
  font-size: 0.8rem;        /* fuente más pequeña */
}
.kpi-table .th-left:hover,
.kpi-table .td-key:hover {
  background: #333 !important;
  color: #fff;
}

/* Anchos específicos */
.kpi-table .th-left.th-fecha,
.kpi-table .td-key.td-fecha {
  width: 88px; min-width: 88px; max-width: 120px;
}

.kpi-table .th-left.th-hora,
.kpi-table .td-key.td-hora {
  width: 64px; min-width: 64px; max-width: 80px;
}

.kpi-table .th-left.th-vendor,
.kpi-table .td-key.td-vendor {
  width: 56px; min-width: 56px; max-width: 72px;
}

.kpi-table .th-left.th-noc_cluster,
.kpi-table .td-key.td-noc_cluster {
  width: 120px; min-width: 110px; max-width: 160px;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}

/* Tech compacto ya considerado */
.kpi-table .th-left.th-technology,
.kpi-table .td-key.td-technology {
  width: 72px; min-width: 72px; max-width: 72px;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}

/* ======= Envoltura ======= */
.kpi-table-wrap {
  max-height: 480px;
  overflow-y: auto;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  border: 1px solid #333;
  border-radius: 8px;
  background: #1e1e1e;
  padding: 0.25rem;
}

/* ======= Severidades ======= */
.cell-ok   { background: #1f3d2b; color: #a6e3b3; }
.cell-warn { background: #3d3520; color: #ffd580; }
.cell-bad  { background: #3d2022; color: #ff9b9b; }

.cell-excelente { background-color: #28a745; color: white; }
.cell-bueno     { background-color: #ffc107; color: black; }
.cell-regular   { background-color: #fd7e14; color: white; }
.cell-critico   { background-color: #dc3545; color: white; }
.cell-neutral   { background-color: #2a2a2a; color: #f1f1f1; }

.cell-good      { background-color: var(--umbral-color-good, #28a745); color:white; }
.cell-warning   { background-color: var(--umbral-color-warning, #ffc107); color:black; }
.cell-critical  { background-color: var(--umbral-color-critical, #dc3545); color:white; }

/* ======= Sorting ======= */
.th-sorted {
  outline: 2px solid rgba(122, 178, 255, 0.35);
  outline-offset: -2px;
  background: #34495e !important;
}
.th-sort-wrap {
  display: grid;
  grid-template-columns: 1fr auto;
  align-items: center;
  gap: .35rem;
  justify-content: center;
}
.sort-btn {
  border: none;
  background: transparent;
  cursor: pointer;
  width: 1.25rem;
  min-width: 1.25rem;
  height: 1.25rem;
  line-height: 1.25rem;
  padding: 0;

  display: inline-flex;
  align-items: center;
  justify-content: center;

  font-size: .9rem;
  color: #f1f1f1;
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Roboto Mono", monospace;
}
.th-sub .th-label {
  white-space: nowrap;
}

/* ======= KPI centrados ======= */
.kpi-table .td-cell {
  text-align: center;
}
.kpi-table .td-cell .kb {
  margin-left: auto;
  margin-right: auto;
}

/* ======= Vendor con inicial (sin imagen) ======= */
.kpi-table .td-key.td-vendor .cell-key > span,
.kpi-table .td-key.td-vendor .vendor-initial {
  display: inline-block;
  width: 1.4rem;
  height: 1.4rem;
  line-height: 1.4rem;
  text-align: center;
  border-radius: 0.35rem;
  font-weight: 700;
  background: #2b2b2b !important;
  color: #f3f3f3;
  vertical-align: middle;
}

/* ======= Cluster: mostrar más contenido (2 líneas con ellipsis) ======= */
.kpi-table .th-left.th-noc_cluster,
.kpi-table .td-key.td-noc_cluster {
  width: 100px;         /* ↑ antes ~120 */
  min-width: 140px;
  max-width: 280px;
}

/* Permitir 2 líneas y cortar con ellipsis si excede */
.kpi-table .td-key.td-noc_cluster .cell-key {
  display: -webkit-box;
  -webkit-line-clamp: 2;          /* 2 líneas visibles */
  -webkit-box-orient: vertical;
  overflow: hidden;
  white-space: normal;            /* permite salto de línea */
  line-height: 1.15;
}
/* ======= Tech: centrar mejor contenido ======= */
.kpi-table .th-left.th-technology,
.kpi-table .td-key.td-technology {
  text-align: center;
}

.kpi-table .td-key.td-technology .cell-key {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;                 /* asegura centrado real en sticky */
  padding-left: 0;             /* quita sesgo visual a la izquierda */
  padding-right: 0;
}

/* Si quieres un poco más de aire visual en Tech: */
.kpi-table .th-left.th-technology,
.kpi-table .td-key.td-technology {
  width: 76px;                 /* opcional: +4px para evitar cortes */
  min-width: 76px;
  max-width: 84px;
}
